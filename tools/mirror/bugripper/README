# /*
# * This file is part of the Alitheia system, developed by the SQO-OSS
# * consortium as part of the IST FP6 SQO-OSS project, number 033331.
# *
# * Copyright 2007-2008 by the SQO-OSS consortium members <info@sqo-oss.eu>
# *
# * Redistribution and use in source and binary forms, with or without
# * modification, are permitted provided that the following conditions are
# * met:
# *
# *     * Redistributions of source code must retain the above copyright
# *       notice, this list of conditions and the following disclaimer.
# *
# *     * Redistributions in binary form must reproduce the above
# *       copyright notice, this list of conditions and the following
# *       disclaimer in the documentation and/or other materials provided
# *       with the distribution.
# *
# * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
# * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
# * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
# * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
# * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
# * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
# * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
# * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
# * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
# * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
# * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
# *
# */


BugRipper Philosofy

The scripts should be executed by cron every N days .
The first execution date is the $start_date and is used as a zero point time reference.
As X*N days have passed the scripts are responsible for having ripped all bugs changed for
all projects  during the ($start_date- X*N) to ($start_date + X*N) period.

This is the intended use, for a soft rip schedule so as not to be targeted by the hosts and
not to spend resources on old most possibly closed bugs.

However , the scripts have parameters that can override this behaviour if executed manually.


Most interesting Files

configure:

# bugripper home ATTENTION!! see endnotes!!
bug_home="/home/sgrig/bugripper"
# data_path Directory of the Projects
data_path="/home/data"
#Current History depth. It is safe to cron the scripts every days_ago
days_ago=7
#Zero Point Date
start_date=$(date --date='2008/09/08' +%s)


project_looper:
Includes the configure file and builds a list of all bugs to be downloaded
All projects are having an info.txt containing a "bts>" commencing line are interrogatedi for changed bugs and a list is build for every project.
All list entries are preceeded with a random 32bit integer.
All project lists all merged and sorted resulting in mixing projects bugs randomly so as to avoid continuous acces to a specific project bugzilla server.
 
The final list is written to  tmpfs/sorted_list.idx
containing all bugs changed in the last N days.

goto_past:
The same as above except for 
The final list is written to  tmpfs/history_sorted_list.idx
As X*N days have passed from the $start_date the script interrogates for bugs changed 
in the (Sstart_date-X*N to $start_Date-(X-1)*N) 
This script just calculates the past dates and calls the project_looper_history script

project_looper_history:
This is  the same as project_looper except for it builds a list for the period specified
in its parameters.
The final list is written to  tmpfs/history_sorted_list.idx

ATTENTION

Each of the above 3 scripts utilises the SAME index filetables and shoud NEVER be executed 
simultaneuosly. Big Mess!

engage_riper:
Reads the 
tmpfs/history_sorted_list.idx
tmpfs/history_sorted_list.idx
lists and downloads the specified bugs .
It sleeps for some secs so as to avoid blocking from the project servers.

rontab Execution: Observe sequence and  time delays

# DO NOT EDIT THIS FILE - edit the master and reinstall.
# (/tmp/crontab.XXXXPmnYDG installed on Wed Oct  1 17:43:42 2008)
# (Cron version V5.0 -- $Id: crontab.c,v 1.12 2004/01/23 18:56:42 vixie Exp $)
00 01 * * 0     /home/sgrig/bugripper/project_looper >> /home/sgrig/bugripper/tmpfs/project_looper.log
00 04 * * 0     /home/sgrig/bugripper/goto_past >> /home/sgrig/bugripper/tmpfs/project_looper_history.log
00 07 * * 0     /home/sgrig/bugripper/engage_ripper 11

End Notes:
The bug_home="/home/sgrig/bugripper" is dummy in the configure file since it cant help from there the scripts to locate the configure file.
In order to work correctly it is supposed to be a preset enviromnment  variable.
To avoid setting environment  the bug_home is redefined in each script .

